#!/bin/bash

# Set Bash strict mode
set -euo pipefail
IFS=$'\n\t'


RED=$(tput setaf 1)
GREEN=$(tput setaf 2)
BLUE=$(tput setaf 4)
NC=$(tput sgr0)


function on_error {
  echo "${RED}CONFIGURATION WAS UNSUCCESSFUL.${NC}"
}

trap on_error ERR

# Only execute this script on a Proxmox Host Node
if ! command -v pveversion &> /dev/null
then
    echo "This script is intended to run on a Proxmox Host Node. Exiting."
    exit
fi

{% for section in sections %}
# BEGIN: {{section.name}}
echo "${BLUE}{{section.name}} ({{loop.index}} / {{ loop.length}})${NC}"
{{section.content}}
# END: {{section.name}}

{% endfor %}

echo "${GREEN}CONFIGURATION COMPLETED SUCCESSFULLY.${NC}"

# Generated by https://github.com/johnknott/proxmox-hetzner-autoconfigure